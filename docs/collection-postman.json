{
	"info": {
		"_postman_id": "ec9c2f31-8185-4e0c-9924-3429a9a4e1fb",
		"name": "desafio-caixaverso",
		"schema": "https://schema.getpostman.com/json/collection/v2.0.0/collection.json",
		"_exporter_id": "23563076",
		"_collection_link": "https://red-shuttle-748693.postman.co/workspace/SHF-Tool~2ab2220a-2442-4cba-a83d-9d909d9da177/collection/23563076-ec9c2f31-8185-4e0c-9924-3429a9a4e1fb?action=share&source=collection_link&creator=23563076"
	},
	"item": [
		{
			"name": "gerar token",
			"event": [
				{
					"listen": "test",
					"script": {
						"exec": [
							"var jsonData = JSON.parse(responseBody);\r",
							"postman.setGlobalVariable(\"tokenGeradoCaixaverso\", jsonData.access_token);\r",
							"\r",
							"var jsonData = pm.response.json();\r",
							"\tpm.environment.set(\"jwt\", jsonData.access_token);\r",
							"\t\r",
							"\t function parseJwt (token,part) {\r",
							"\t   var base64Url = token.split('.')[part];\r",
							"\t   var words = CryptoJS.enc.Base64.parse(base64Url);\r",
							"\t   var jsonPayload = CryptoJS.enc.Utf8.stringify(words);\r",
							"\t   return  JSON.parse(jsonPayload);\r",
							"\t};\r",
							"\t\r",
							"\r",
							"\tvar jwtInfo ={};\r",
							"\tjwtInfo.size = jsonData.access_token.length;\r",
							"\tjwtInfo.header = parseJwt(jsonData.access_token,0);\r",
							"\tjwtInfo.payload = parseJwt(jsonData.access_token,1);\r",
							"\tjwtInfo.signature = jsonData.access_token.split('.')[2];\r",
							"\tjwtInfo.expires = ((jwtInfo.payload.exp-Date.now().valueOf()/1000)/60).toFixed(1);\r",
							"\tconsole.log(jwtInfo);\r",
							"\t\r",
							"\r",
							"\tvar template = `\r",
							"\t<b>JWT  Size:{{response.size}}Bytes. Expires in {{response.expires}} minutes</b><br>\r",
							"\t<b>Header </b>\r",
							"\t    <table>\r",
							"\t        <tr><th>Property</th><th>Value</th></tr>\r",
							"\t        {{#each response.header}}\r",
							"\t            <tr><td>{{@key}}</td><td>{{.}}</td></tr>\r",
							"\r",
							"\t        {{/each}}\r",
							"\t    </table>\r",
							"\t<b>Payload</b>\r",
							"\t    <table>\r",
							"\t        <tr><th>Property</th><th>Value</th></tr>\r",
							"\t        {{#each response.payload}}\r",
							"\t            <tr><td>{{@key}}</td><td>{{.}}</td></tr>\r",
							"\r",
							"\t        {{/each}}\r",
							"\t    </table>\r",
							"\t <b>Claims</b>\r",
							"\t    <table bgcolor=\"#FFFFFF\">\r",
							"\t        <tr><th>Claim</th><th>Value</th></tr>\r",
							"\t        {{#each response.payload.Claims}}\r",
							"\t            <tr>\r",
							"\t                {{#each this}}\r",
							"\t                    <td>{{.}}</td>       \r",
							"\t                {{/each}}\r",
							"\t            </tr>\r",
							"\t        {{/each}}\r",
							"\t    </table>\r",
							"\t  <i>signature:{{response.signature}}</i>\r",
							"\t`;\r",
							"\tpm.visualizer.set(template, {response: jwtInfo});"
						],
						"type": "text/javascript",
						"packages": {},
						"requests": {}
					}
				}
			],
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Content-Type",
						"value": "application/x-www-form-urlencoded"
					}
				],
				"body": {
					"mode": "urlencoded",
					"urlencoded": [
						{
							"key": "grant_type",
							"value": "password",
							"type": "text"
						},
						{
							"key": "client_id",
							"value": "api-caixaverso",
							"type": "text"
						},
						{
							"key": "client_secret",
							"value": "super-secret",
							"type": "text"
						},
						{
							"key": "username",
							"value": "useradmin",
							"type": "text"
						},
						{
							"key": "password",
							"value": "123",
							"type": "text"
						}
					]
				},
				"url": "http://localhost:8081/realms/caixaverso/protocol/openid-connect/token",
				"description": "Generated from cURL: curl -X POST http://localhost:8081/realms/caixaverso/protocol/openid-connect/token -H \"Content-Type: application/x-www-form-urlencoded\" -d grant_type=password -d client_id=api-caixaverso -d client_secret=super-secret -d username=user1 -d password=123"
			},
			"response": []
		},
		{
			"name": "Produtos Recomendados",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": {
						"token": "{{tokenGeradoCaixaverso}}"
					}
				},
				"method": "GET",
				"header": [],
				"url": "http://localhost:8080/api/v1/produtos-recomendados/agressivo"
			},
			"response": []
		},
		{
			"name": "Simulação de Investimeto",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": {
						"token": "{{tokenGeradoCaixaverso}}"
					}
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "{\r\n    \"clienteId\": 123,\r\n    \"valor\": 10000.00,\r\n    \"prazoMeses\": 12,\r\n    \"tipoProduto\": \"CDB\"\r\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": "http://localhost:8080/api/v1/simular-investimento/"
			},
			"response": []
		},
		{
			"name": "Histórico de Simulações Realizadas",
			"protocolProfileBehavior": {
				"disableBodyPruning": true
			},
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": {
						"token": "{{tokenGeradoCaixaverso}}"
					}
				},
				"method": "GET",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": ""
				},
				"url": "http://localhost:8080/api/v1/simulacoes"
			},
			"response": []
		},
		{
			"name": "Valores Simulados por Produto e Dia",
			"request": {
				"method": "GET",
				"header": [],
				"url": "http://localhost:8080/api/v1/simulacoes/por-produto-dia"
			},
			"response": []
		},
		{
			"name": "Dados de Telemetria",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": {
						"token": "{{tokenGeradoCaixaverso}}"
					}
				},
				"method": "GET",
				"header": [],
				"url": "http://localhost:8080/api/v1/telemetria"
			},
			"response": []
		},
		{
			"name": "Perfil de Risco",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": {
						"token": "{{tokenGeradoCaixaverso}}"
					}
				},
				"method": "GET",
				"header": [],
				"url": "http://localhost:8080/api/v1/perfil-risco/102"
			},
			"response": []
		},
		{
			"name": "Produtos Recomendados",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": {
						"token": "{{tokenGeradoCaixaverso}}"
					}
				},
				"method": "GET",
				"header": [],
				"url": "http://localhost:8080/api/v1/produtos-recomendados/conservador"
			},
			"response": []
		},
		{
			"name": "Histórico de Investimentos",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": {
						"token": "{{tokenGeradoCaixaverso}}"
					}
				},
				"method": "GET",
				"header": [],
				"url": "http://localhost:8080/api/v1/investimentos/123"
			},
			"response": []
		}
	],
	"variable": [
		{
			"key": "token",
			"value": "",
			"type": "default"
		},
		{
			"key": "tokenGerado",
			"value": "",
			"type": "default"
		}
	]
}